<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title><%= $title %></title>
        <link href="/main.css" rel="stylesheet">
	</head>
	<body>
		<input type="radio" id="ui-panel-switch-login" name="ui-panel-switch" hidden>
		<input type="radio" id="ui-panel-switch-join" name="ui-panel-switch" hidden checked>
		<div id="ui-panel">
			% if ($c->session('user_id')) {
			<div id="user">
				<a href="/edit/page">Edit</a>
				<a href="/delete/page">Delete</a>
				<a href="<%= url_for('user_logout') %>"class="button">Log Out</a>
			</div>
			% } else {
			<div id="join">
				<div class="form-container">
					<form action="<%= url_for('user_join') %>" method="POST">
						<div>
							<label for="join-email">Email</label>
							<input type="email" id="join-email" name="join-email" required>
						</div>
						<div>
							<label for="join-username">Username</label>
							<input type="text" placeholder="[a-zA-Z][a-zA-Z0-9_-]*" pattern="[a-zA-Z][a-zA-Z0-9_-]*" id="join-username" name="join-username" maxlength="31" required>
						</div>
						<div>
							<label for="join-password">Password</label>
							<input type="password" id="join-password" name="join-password" minlength="8" required>
						</div>
						<button type="submit">Join</button>
					</form>
					<label id="ui-panel-switch-login" class="switch" for="ui-panel-switch-login">Login</label>
				</div>
			</div>
			<div id="login">
				<div class="form-container">
					<label id="ui-panel-switch-join" class="switch" for="ui-panel-switch-join">Join</label>
					<form action="<%= url_for('user_login') %>" method="POST">
						<div>
							<label for="login-username">Username</label>
							<input type="text" id="login-username" name="login-username" required>
						</div>
						<div>
							<label for="login-password">Password</label>
							<input type="password" id="login-password" name="login-password" required>
						</div>
						<button type="submit">Login</button>
					</form>
					<div>
						% if ($c->app->mode eq 'development') {
						<a href="http://blip.local:3000/forgot-password">Forgot Password</a>
						% } else {
						<a href="https://blip.town/forgot-password">Forgot Password</a>
						% }
					</div>
				</div>
			</div>
			% }
		</div>
		<input type="checkbox" id="ui-panel-toggle" hidden>
		<div id="viewport">
			<input type="checkbox" id="menu-toggle" hidden>
			<label id="menu-toggle" class="button" for="menu-toggle"></label>
			<label id="ui-panel-toggle" class="button" for="ui-panel-toggle"></label>
			<div id="sidebar">
				<header>
					<h1><%== $header %></h1>
				</header>
				<nav>
					<%== $sidebar %>
				</nav>
				<footer>
					<%== $footer %>
				</footer>
			</div>
			<main>
				<div id="content" class="<%= $layout %>">
					<%== $content %>
				</div>
			</main>
		</div>
	</body>
</html>
